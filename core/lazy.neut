(no-implicit-core)

(include library "core/foundation.neut")

(inductive lazy ((a tau))
  (unfold ((x (pi () a)))
    (lazy a)))

(section lazy)

(define thunk ((a tau) (x a))
  (witness (lazy a)
    (lazy.unfold a
      (lambda () x))))

;; (attribute thunk
;;   (implicit 0))

(define force ((a tau) (x (lazy a)))
  (witness a
    (lazy.fold a
      x
      (lambda (_)
        a)
      (lambda (acc)
        (acc)))))

;; (attribute force
;;   (implicit 0))

(end lazy)
