(no-implicit-core)

(include library "core/foundation.neut")

(inductive lazy ((a tau))
  (unfold ((x (pi () a)))
    (lazy a)))

(section lazy)

(define thunk ((a tau) (x a))
  (witness (lazy a)
    (unfold
      (lambda () x))))

(attribute lazy.thunk
  (implicit 0))

(define force ((a tau) (x (lazy a)))
  (witness a
    (fold x
      (lambda (_)
        a)
      (lambda (acc)
        (acc)))))

(attribute lazy.force
  (implicit 0))

(end lazy)
